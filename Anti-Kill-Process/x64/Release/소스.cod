; Listing generated by Microsoft (R) Optimizing Compiler Version 19.29.30141.0 

include listing.inc

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	ExPoolZeroingNativelySupported
;	COMDAT ExPoolZeroingNativelySupported
_BSS	SEGMENT
ExPoolZeroingNativelySupported DB 01H DUP (?)
_BSS	ENDS
PUBLIC	DriverEntry
EXTRN	__imp_PsLookupProcessByProcessId:PROC
;	COMDAT pdata
pdata	SEGMENT
$pdata$DriverEntry DD imagerel $LN6
	DD	imagerel $LN6+52
	DD	imagerel $unwind$DriverEntry
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$DriverEntry DD 030902H
	DD	06001601H
	DD	04209H
xdata	ENDS
; Function compile flags: /Ogsp
; File C:\Users\Lamed\Desktop\Anti-Kill-Process\Anti-Kill-Process\¼Ò½º.c
;	COMDAT DriverEntry
_TEXT	SEGMENT
pDrvObj$ = 48
pEprocess$ = 56
pRegistryPath$ = 56
DriverEntry PROC					; COMDAT

; 4    : {

$LN6:
  00000	48 89 54 24 10	 mov	 QWORD PTR [rsp+16], rdx
  00005	48 83 ec 28	 sub	 rsp, 40			; 00000028H

; 5    :     pDrvObj = pDrvObj;
; 6    :     pRegistryPath = pRegistryPath;
; 7    : 
; 8    :     ULONG ProcessId = 0x99999999;
; 9    :     if (ProcessId == 0)
; 10   :         goto exit;
; 11   : 
; 12   :     PEPROCESS pEprocess = NULL;

  00009	48 83 64 24 38
	00		 and	 QWORD PTR pEprocess$[rsp], 0

; 13   :     PsLookupProcessByProcessId((HANDLE)ProcessId, &pEprocess);

  0000f	48 8d 54 24 38	 lea	 rdx, QWORD PTR pEprocess$[rsp]
  00014	b9 99 99 99 99	 mov	 ecx, -1717986919	; ffffffff99999999H
  00019	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_PsLookupProcessByProcessId

; 14   :     if (pEprocess)

  0001f	48 8b 44 24 38	 mov	 rax, QWORD PTR pEprocess$[rsp]
  00024	48 85 c0	 test	 rax, rax
  00027	74 04		 je	 SHORT $LN3@DriverEntr

; 15   :         *(unsigned char*)((unsigned char*)pEprocess - 0x15) = 0x14;

  00029	c6 40 eb 14	 mov	 BYTE PTR [rax-21], 20
$LN3@DriverEntr:

; 16   : 
; 17   :     return STATUS_SUCCESS;

  0002d	33 c0		 xor	 eax, eax

; 18   : exit:
; 19   :     return STATUS_UNSUCCESSFUL;
; 20   : }

  0002f	48 83 c4 28	 add	 rsp, 40			; 00000028H
  00033	c3		 ret	 0
DriverEntry ENDP
_TEXT	ENDS
END
